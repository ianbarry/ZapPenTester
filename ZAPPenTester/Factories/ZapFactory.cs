using System;

namespace ZAPPenTester.Factories
{
    /// <summary>
    /// This class is responsible for creating instances of Zap
    /// </summary>
    public class ZapFactory
    {
        public static Zap Create(string[] commandArguments)
        {
            var urls = commandArguments[0].Split(',');
            var scanType = (ScanType) Enum.Parse(typeof(ScanType), commandArguments[1], true);

            var settings = new Settings();
            var logger = new CommandLineLogger();
            var httpClientHelper = new HttpClientHelper(settings);
            var scanner = new Scanner(settings, logger, httpClientHelper);
            var reporting = new Reporting(settings,logger,httpClientHelper);
            var spider = new Spider(settings, logger, httpClientHelper);
            var zapScan = new ZapScan(urls, scanType);
        
            return new Zap( settings, logger, scanner, reporting, spider, zapScan);
        }
    }
}