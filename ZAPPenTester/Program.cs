using System;

using ZAPPenTester.Factories;
using ZAPPenTester.Models;

namespace ZAPPenTester
{
    /// <summary>
    /// This class is responsible for providing the starting point of the application. 
    /// This application will open ZAP, start the scan and report the findings.
    /// </summary>
    public class Program
    {
        public static void Main(string[] args)
        {
            if (args != null && args.Length == 2)
            {
                var zap = ZapFactory.Create(args);

                zap.Open();
                zap.Scan();
                var reports = zap.GetReports();
                zap.Close();

                new CommandLineReportPrinter().Print(reports);
            }
            else
            {
                throw new ArgumentException("This tool requires that you provide atleast one URL of the site to be tested as argument and the type of scan (spider or activescan), in the format http://www.SiteToTest.com");
            }
        }
    }
}